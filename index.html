<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CHEF PRO</title>
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#000000">

<style>
body{margin:0;font-family:Arial;background:#111;color:#fff}
header{background:#000;padding:15px;text-align:center;font-size:22px;font-weight:bold}
nav{display:flex;justify-content:space-around;background:#1a1a1a;padding:10px}
nav button{background:none;border:none;color:#fff;font-size:16px}
section{padding:15px}
input,select,textarea,button{width:100%;margin-bottom:8px;padding:10px;border-radius:6px;border:none}
button{background:#fff;color:#000;font-weight:bold}
.card{background:#222;padding:10px;border-radius:6px;margin-bottom:10px}
.hidden{display:none}
.suggest{background:#333;padding:8px;border-radius:6px;margin-top:-6px}
.suggest div{padding:5px;border-bottom:1px solid #444}
.suggest div:last-child{border:none}
</style>
</head>

<body>

<header>CHEF PRO</header>

<nav>
<button onclick="showPage('home')">NUOVA</button>
<button onclick="showPage('ricette')">RICETTE</button>
</nav>

<section id="home">
<h2>Nuova Ricetta</h2>

<input id="nome" placeholder="Nome ricetta">

<select id="categoria">
<option>Antipasti</option>
<option>Primi</option>
<option>Secondi</option>
<option>Dolci</option>
<option>Preparazioni base</option>
</select>

<h3>Ingredienti</h3>
<input id="ingInput" placeholder="Ingrediente">
<div id="suggestioni" class="suggest hidden"></div>
<input id="ingQuantita" placeholder="Quantità">
<button onclick="aggiungiIngrediente()">Aggiungi ingrediente</button>

<div id="listaIngredienti"></div>

<h3>Procedimento</h3>
<div id="passaggi"></div>
<button onclick="aggiungiPassaggio()">➕ Aggiungi passaggio</button>

<input id="finitura" placeholder="Finitura del piatto">

<button onclick="salvaRicetta()">Salva ricetta</button>
</section>

<section id="ricette" class="hidden">
<div id="listaRicette"></div>
</section>

<script>
let ricette = JSON.parse(localStorage.getItem("ricette")) || [];
let ingredientDB = JSON.parse(localStorage.getItem("ingredientDB")) || 
["Pomodoro","Patata","Cipolla","Aglio","Olio extravergine","Sale","Pepe","Zucchero","Farina","Uova","Latte","Burro"];

let ingredientiTemp=[];
let passaggiTemp=[];

function showPage(id){
 document.querySelectorAll("section").forEach(s=>s.classList.add("hidden"));
 document.getElementById(id).classList.remove("hidden");
 renderRicette();
}

function aggiungiIngrediente(){
 if(!ingInput.value || !ingQuantita.value) return;
 if(!ingredientDB.includes(ingInput.value)){
  ingredientDB.push(ingInput.value);
  localStorage.setItem("ingredientDB",JSON.stringify(ingredientDB));
 }
 ingredientiTemp.push({nome:ingInput.value,quantita:ingQuantita.value});
 ingInput.value="";ingQuantita.value="";
 suggerimenti.classList.add("hidden");
 renderIngredienti();
}

function renderIngredienti(){
 listaIngredienti.innerHTML="";
 ingredientiTemp.forEach(i=>{
  listaIngredienti.innerHTML+=
   `<div class="card">${i.nome} – ${i.quantita}</div>`;
 });
}

ingInput.oninput=()=>{
 let v=ingInput.value.toLowerCase();
 if(!v){suggerimenti.classList.add("hidden");return;}
 suggerimenti.innerHTML="";
 ingredientDB.filter(i=>i.toLowerCase().includes(v)).forEach(i=>{
  let d=document.createElement("div");
  d.textContent=i;
  d.onclick=()=>{ingInput.value=i;suggerimenti.classList.add("hidden");};
  suggerimenti.appendChild(d);
 });
 suggerimenti.classList.remove("hidden");
}

function aggiungiPassaggio(){
 passaggiTemp.push("");
 renderPassaggi();
}

function renderPassaggi(){
 passaggi.innerHTML="";
 passaggiTemp.forEach((p,i)=>{
  passaggi.innerHTML+=
   `<textarea placeholder="Passaggio ${i+1}" 
    oninput="passaggiTemp[${i}]=this.value">${p}</textarea>`;
 });
}

function salvaRicetta(){
 if(!nome.value)return;
 ricette.push({
  nome:nome.value,
  categoria:categoria.value,
  ingredienti:ingredientiTemp,
  procedimento:passaggiTemp,
  finitura:finitura.value
 });
 localStorage.setItem("ricette",JSON.stringify(ricette));
 nome.value="";finitura.value="";
 ingredientiTemp=[];passaggiTemp=[];
 renderIngredienti();renderPassaggi();
}

function renderRicette(){
 listaRicette.innerHTML="";
 ricette.forEach(r=>{
  listaRicette.innerHTML+=
   `<div class="card"><strong>${r.nome}</strong><br>${r.categoria}</div>`;
 });
}
</script>

</body>
</html>
