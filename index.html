<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CHEF PRO</title>

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#000000">

<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: #111;
  color: #fff;
}
header {
  background: #000;
  padding: 15px;
  text-align: center;
  font-size: 22px;
  font-weight: bold;
}
nav {
  display: flex;
  justify-content: space-around;
  background: #1a1a1a;
  padding: 10px;
}
nav button {
  background: none;
  border: none;
  color: #fff;
  font-size: 16px;
}
section {
  padding: 15px;
}
input, select, textarea, button {
  width: 100%;
  margin-bottom: 8px;
  padding: 10px;
  border-radius: 6px;
  border: none;
  font-size: 15px;
}
button {
  background: #fff;
  color: #000;
  font-weight: bold;
}
.card {
  background: #222;
  padding: 10px;
  border-radius: 6px;
  margin-bottom: 10px;
}
.hidden { display: none; }
.total {
  font-size: 18px;
  font-weight: bold;
  margin-top: 10px;
}

/* STAMPA */
@media print {
  body { background:#fff; color:#000; }
  nav, button { display:none; }
  .card { border:1px solid #000; }
}
</style>
</head>

<body>

<header>CHEF PRO</header>

<nav>
  <button onclick="showPage('home')">âž• Nuova</button>
  <button onclick="showPage('categorie')">ðŸ“‚ Categorie</button>
</nav>

<section id="home">
  <h2>Nuova Ricetta</h2>
  <input id="nome" placeholder="Nome ricetta">
  <select id="categoria"></select>
  <textarea id="descrizione" placeholder="Procedimento"></textarea>
  <button onclick="salvaRicetta()">Salva Ricetta</button>
</section>

<section id="categorie" class="hidden">
  <input id="cerca" placeholder="Cerca in tutte le ricette..." oninput="cercaRicette()">
  <div id="risultatiRicerca"></div>
  <h3>Categorie</h3>
  <div id="listaCategorie"></div>
</section>

<section id="ricetta" class="hidden">
  <h2 id="titoloRicetta"></h2>
  <p id="testoRicetta"></p>

  <h3>Ingredienti</h3>
  <input id="ingNome" placeholder="Ingrediente">
  <input id="ingCosto" type="number" placeholder="Costo â‚¬/kg o â‚¬/pz">
  <input id="ingQuantita" type="number" placeholder="QuantitÃ  usata">
  <button onclick="aggiungiIngrediente()">Aggiungi ingrediente</button>

  <div id="listaIngredienti"></div>
  <div class="total" id="totaleCosto"></div>

  <button onclick="window.print()">ðŸ–¨ Stampa scheda ricetta</button>

  <div class="card">
    <p><strong>Chef:</strong> ____________________________</p>
    <p><strong>Data Produzione:</strong> ____________________________</p>
    <p><strong>Data Abbattimento:</strong> ____________________________</p>
    <p><strong>Stoccaggio:</strong> ____________________________</p>
    <p><strong>Lotto:</strong> ____________________________</p>
  </div>
</section>

<script>
let categorie=["Antipasti","Primi","Secondi","Dolci"];
let ricette=JSON.parse(localStorage.getItem("ricette"))||[];
let ricettaAttiva=null;

function showPage(id){
 document.querySelectorAll("section").forEach(s=>s.classList.add("hidden"));
 document.getElementById(id).classList.remove("hidden");
}

function aggiornaCategorie(){
 const s=document.getElementById("categoria");
 s.innerHTML="";
 categorie.forEach(c=>{
  let o=document.createElement("option");
  o.textContent=o.value=c;
  s.appendChild(o);
 });
}

function salvaRicetta(){
 const n=nome.value, c=categoria.value, d=descrizione.value;
 if(!n)return;
 ricette.push({nome:n,categoria:c,descrizione:d,ingredienti:[]});
 localStorage.setItem("ricette",JSON.stringify(ricette));
 nome.value=""; descrizione.value="";
}

function mostraRicetta(r){
 ricettaAttiva=r;
 showPage("ricetta");
 titoloRicetta.textContent=r.nome;
 testoRicetta.textContent=r.descrizione;
 aggiornaIngredienti();
}

function aggiungiIngrediente(){
 const n=ingNome.value;
 const c=parseFloat(ingCosto.value);
 const q=parseFloat(ingQuantita.value);
 if(!n||!c||!q)return;
 ricettaAttiva.ingredienti.push({nome:n,costo:c,quantita:q});
 localStorage.setItem("ricette",JSON.stringify(ricette));
 ingNome.value=""; ingCosto.value=""; ingQuantita.value="";
 aggiornaIngredienti();
}

function aggiornaIngredienti(){
 listaIngredienti.innerHTML="";
 let tot=0;
 ricettaAttiva.ingredienti.forEach(i=>{
  let costo=(i.costo*i.quantita)/1000;
  tot+=costo;
  listaIngredienti.innerHTML+=`<div class="card">${i.nome} - â‚¬ ${costo.toFixed(2)}</div>`;
 });
 totaleCosto.textContent="Costo totale ricetta: â‚¬ "+tot.toFixed(2);
}

function cercaRicette(){
 const t=cerca.value.toLowerCase();
 risultatiRicerca.innerHTML="";
 ricette.filter(r=>r.nome.toLowerCase().includes(t)).forEach(r=>{
  let d=document.createElement("div");
  d.className="card";
  d.textContent=r.nome+" ("+r.categoria+")";
  d.onclick=()=>mostraRicetta(r);
  risultatiRicerca.appendChild(d);
 });
}

aggiornaCategorie();
</script>

</body>
</html>

